%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:

In the same manner as Bitcoin distributes and organizes its financial
information through a blockchain, we can achieve the same, only with
log messages. The data in the Body of a block is of no significance to
functionality of the blockchain, only the hash there of.



\subsection{Log entry}
The specification of the structure of a log entry is not important as
all the servers agree. For the purpose of comprehensiveness we include
a sample format which contains some meta-data and a log message.
\begin{table}[H]
  \centering
  \begin{tabular}{c|c|l}
    Field                & Data type       & Format                                    \\ \hline
    \texttt{version}     & \texttt{string} & Version of log entry format               \\
    \texttt{timestamp}   & \texttt{string} & Standard timestamp (ISO 8601)             \\
    \texttt{host-id}     & \texttt{string} & ID of node in blockchain                  \\
    \texttt{application} & \texttt{string} & Name of application or device             \\
    \texttt{pid}         & \texttt{int}    & Process id of the application             \\
    \texttt{message}     & \texttt{string} & Logged message in UTF-8 encoding
  \end{tabular}
  \caption{\label{tab:log-entry} Structure of an log entry}
\end{table}
We include the version of the log entry format, so if we update it, we
can preserve backwards compatibility.

The log entries can then be, using the format above, be encoded using
any format and sent as a part of a blockchain transaction. A common
format used when transmitting data objects is, for instance, the
human-readable format JSON.


\subsection{Confidentiality}
Although the blockchain is private, hence cannot be read by hosts
outside the network, if a server is compromised, an adversary could
read the log entries of all nodes on the network. This is, of course,
very bad. Therefore, vi could apply public-key encryption to all log
entries, before hashing and generating the Merkle root. Consequently,
all notes can ensure the validity of all data and blocks, but only the
node with private key can read the actual log entries. This key could
then be given to the central server so it can do its job by monitoring
the logs.

In the illustration below, in figure~\ref{fig:merkle-root-crypt}, we
see an example where the log entries are encrypted before the Merkle
root is computed. The log entries below the ``Not Distributed'' line
are never sent over the network.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.6]{figures/merkle-root-crypt.png}
  \caption{\label{fig:merkle-root-crypt} Merkle root with public key enctryption}
\end{figure}


TODO not light weight


\subsection{Tie together threats and blockchain section}

\subsection{Illustrate and explain applied scenario}

\subsubsection{Large storage consumption?}
% https://bitcoin.stackexchange.com/questions/10479/what-is-the-merkle-root
No, because only block header and Merkle root needs to be downloaded,
and Merkle root is enough to confirm that block was accepted by
network.

\begin{figure}[ht]
  \centering
  \includegraphics[scale=0.6]{figures/blockchain-header.png}
  \caption{\label{fig:blockchain-header} Header of a single block}
\end{figure}


\subsection{Which threats are handled?}
IMPORTANT, part of project def.

\subsection{What threats is not handled}
IMPORTANT, part of project def.


TODO private network central hacked
